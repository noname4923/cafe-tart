<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Maze Game</title>
    <style>
        body {
            background-color: skyblue;
            color: white;
            font-family: 'Arial', sans-serif;
            padding: 20px;
            margin: 0;
            transition: background-color 1s;
        }
        #game-container {
            margin: auto;
            width: 80%;
            max-width: 600px;
            padding: 20px;
        }
        .story-section {
            margin-bottom: 40px;
            padding: 20px;
            background-color: #222;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }
        .ad-container {
            display: none;
            margin-top: 20px;
            background-color: #444;
            padding: 10px;
            border-radius: 5px;
        }
        button {
            background-color: #444;
            color: white;
            border: none;
            padding: 10px 20px;
            margin: 10px;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background-color: #666;
        }
    </style>
</head>
<body>
    <div id="game-container">
        <div id="story"></div>
        <div id="ad-container" class="ad-container">
            <!-- 광고를 위한 공간 -->
            <p>광고가 재생 중입니다...</p>
        </div>
    </div>
    <script>
    const stages = [
        { 
            id: 1,
            description: "당신은 기묘한 초대장을 받았다. \"당신의 용기를 시험할 시간입니다. 미궁에 들어와서 당신의 운명을 찾으세요.\" 호기심과 약간의 두려움을 안고, 당신은 초대장에 적힌 주소로 향한다. 어둡고 울창한 숲 속 깊은 곳, 오래된 성처럼 보이는 건물이 서 있었다. 성문은 서서히 열리며 끼익거리는 소리를 냈다. 당신은 깊은 숨을 들이마시고, 성 안으로 발을 디딘다.",
            choices: [
                { text: "성 안으로 들어간다", nextStage: 2 }
            ]
        },
        { 
            id: 2,
            description: "성 안은 어둡고 습한 냄새로 가득했다. 당신이 한 발짝 한 발짝 내디딜 때마다, 마치 당신을 기다렸다는 듯이 촛불이 하나씩 켜졌다. 벽에는 오래된 그림들이 걸려 있고, 낡은 가구들이 곳곳에 놓여 있었다. 길게 뻗은 복도 끝에는 두 개의 문이 있었다. 하나는 검은색, 다른 하나는 붉은색이었다.",
            choices: [
                { text: "검은색 문을 연다", nextStage: 3, changeBgTo: 'black' },
                { text: "붉은색 문을 연다", nextStage: 4, changeBgTo: 'darkred' }
            ]
        },
        { 
            id: 3,
            description: "검은 문을 선택하면, 공포가 서서히 다가오는 느낌이 든다. 문을 열자마자 차가운 바람이 불어오며, 어두운 계단이 아래로 이어진다. 계단을 내려가면, 고요함 속에서 무언가가 당신을 지켜보고 있는 듯한 느낌이 든다.",
            choices: [
                { text: "계속 진행한다", nextStage: 5 }
            ]
        },
        { 
            id: 4,
            description: "붉은 문을 선택하면, 피비린내와 함께 약간의 온기가 느껴진다. 문을 열면, 붉은 조명이 켜진 긴 복도가 나타난다. 복도 끝에는 낡은 피아노가 놓여 있고, 저절로 연주되기 시작한다. 연주 소리는 점점 더 빠르고 불안하게 변한다.",
            choices: [
                { text: "복도를 따라간다", nextStage: 5 }
            ]
        },
        { 
            id: 5,
            description: "이제 당신의 운명은 여기에 달려 있습니다. 무엇을 선택하겠습니까?",
            choices: [
                { text: "게임을 종료한다", nextStage: 0 }
            ]
        }
    ];

    // 각 스테이지에 대한 정보를 담은 배열입니다. 각 스테이지에는 고유한 id, 설명(description), 
    // 그리고 선택지(choices)가 포함되어 있습니다. 선택지는 텍스트와 다음 스테이지를 가리키는 nextStage, 
    // 배경색을 변경하는 changeBgTo 옵션을 포함합니다.

    let currentStage = 1;

    // 현재 스테이지를 나타내는 변수입니다. 초기 값은 1로 설정됩니다.

    function loadStage(stageId) {
        const stage = stages.find(s => s.id === stageId);
        // 현재 스테이지를 id를 통해 찾아냅니다.
        
        const storyContainer = document.getElementById('story');
        const section = document.createElement('div');
        section.className = 'story-section';
        // 새로운 스토리 섹션을 생성하고, 클래스를 지정합니다.
        
        const description = document.createElement('p');
        description.textContent = stage.description;
        section.appendChild(description);
        // 현재 스테이지의 설명을 p 요소에 넣고, 섹션에 추가합니다.
        
        const choicesContainer = document.createElement('div');
        stage.choices.forEach(choice => {
            const button = document.createElement('button');
            button.textContent = choice.text;
            button.onclick = () => {
                if (choice.nextStage !== 0) {
                    if (choice.changeBgTo) {
                        changeBackgroundColor(choice.changeBgTo);
                    }
                    loadStage(choice.nextStage);
                } else {
                    alert('게임을 종료합니다.');
                    document.body.innerHTML = '';
                }
            };
            choicesContainer.appendChild(button);
        });
        // 각 선택지에 대해 버튼을 생성하고, 클릭 이벤트를 설정합니다. 
        // 버튼이 클릭되면 다음 스테이지로 이동하고, 필요하면 배경색을 변경합니다. 
        // 게임 종료 선택 시 경고 메시지를 띄우고, 페이지 내용을 비웁니다.
        
        section.appendChild(choicesContainer);
        storyContainer.appendChild(section);
        section.scrollIntoView({ behavior: 'smooth' });
        // 선택지를 섹션에 추가하고, 스토리 컨테이너에 섹션을 추가합니다.
        // 새 섹션이 부드럽게 스크롤되도록 설정합니다.
    }

    function showAd() {
        const adContainer = document.getElementById('ad-container');
        adContainer.style.display = 'block';
        setTimeout(() => {
            adContainer.style.display = 'none';
        }, 5000);
    }
    // 광고를 5초 동안 표시하는 함수입니다.

    function changeBackgroundColor(targetColor) {
        let currentColor = window.getComputedStyle(document.body).backgroundColor;
        let targetRgb = targetColor === 'black' ? [0, 0, 0] : [139, 0, 0]; // darkred
        let currentRgb = currentColor.match(/\d+/g).map(Number);
        let step = 0;

        function transition() {
            if (step < 100) {
                currentRgb = currentRgb.map((color, index) => color + (targetRgb[index] - color) * 0.01);
                document.body.style.backgroundColor = `rgb(${currentRgb.map(Math.round).join(',')})`;
                step++;
                requestAnimationFrame(transition);
            }
        }
        transition();
    }
    // 배경색을 부드럽게 전환하는 함수입니다. 현재 배경색과 목표 배경색을 점진적으로 변화시킵니다.
   
    // 페이지가 로드되면 초기 스테이지를 불러오는 함수입니다.
    window.onload = () => {
        loadStage(currentStage);
    };
    
    </script>
</body>
</html>
